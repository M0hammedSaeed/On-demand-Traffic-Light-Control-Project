/*******************************************************************************
 * [ File Name ]: steper_motor.c
 *
 * [Description]: Source File that contain functions prototypes Stepper Motor.
 *
 * [   Author  ]: Mohamed Saeed
 *
 *********************************************************************************/

/*------------------------------------------------------------------------------
 *                                  Includes
 -------------------------------------------------------------------------------*/

#include "stepper_motor.h"
#include "util/delay.h"

/*------------------------------------------------------------------------------
 *                               FUNCTIONS IMPLEMENTATION
 *------------------------------------------------------------------------------*/

void STEPPER_Init(void)
{
	/* Set the direction output for the Pins connected to the Stepper Motor */
	GPIO_SetPinDir(STEPPER_PORT, STEPPER_COIL1_PIN, pin_output);
	GPIO_SetPinDir(STEPPER_PORT, STEPPER_COIL2_PIN, pin_output); //0x00
	GPIO_SetPinDir(STEPPER_PORT, STEPPER_COIL3_PIN, pin_output);
	GPIO_SetPinDir(STEPPER_PORT, STEPPER_COIL4_PIN, pin_output);
}

void STEPPER_RotateCW(Stepper_Mode_t Mode)
{
	switch(Mode)
	{
	case STEPPER_FULL_STEP_MODE:
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x0C
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x06
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x03
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x09
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);
		break;

	case STEPPER_HALF_STEP_MODE:
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x08
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x0C
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x04
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x06
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x02
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x03
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x01
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x09
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);
		break;
	}
}

void STEPPER_RotateACW(Stepper_Mode_t Mode)
{
	switch(Mode)
	{
	case STEPPER_FULL_STEP_MODE:


		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x09
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x03
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x6
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x0C
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);
		break;

	case STEPPER_HALF_STEP_MODE:
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x09
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x01
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x03
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x02
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_HIGH);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x06
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x04
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_LOW);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_HIGH); //0x0C
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);

		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL1_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL2_PIN, LOGIC_LOW);
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL3_PIN, LOGIC_LOW); //0x08
		GPIO_WritePin(STEPPER_PORT, STEPPER_COIL4_PIN, LOGIC_HIGH);
		_delay_ms(500);
		break;
	}

}
